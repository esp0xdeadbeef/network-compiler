{"meta":{"compiler":{"gitDirty":false,"gitRev":"dirty"}},"sites":{"esp0xdeadbeef.site-a":{"addressPools":{"local":{"ipv4":"10.19.0.0/24","ipv6":"fd42:dead:beef:1900::/118"},"p2p":{"ipv4":"10.10.0.0/24","ipv6":"fd42:dead:beef:1000::/118"}},"attachment":[{"segment":"tenants:mgmt","unit":"s-router-access"},{"segment":"tenants:admin","unit":"s-router-access"},{"segment":"tenants:clients","unit":"s-router-access"}],"communicationContract":{"allowedRelations":[{"action":"allow","from":{"subject":"admin"},"proto":["udp/53","tcp/53"],"source":{"id":"allow-admin-to-mgmt-dns","index":0,"kind":"rule","priority":100},"to":{"capability":"resolver","subject":"mgmt"}},{"action":"deny","from":{"subject":"clients"},"proto":["udp/53","tcp/53"],"source":{"id":"deny-clients-to-mgmt-dns","index":1,"kind":"rule","priority":90},"to":{"capability":"resolver","subject":"mgmt"}},{"action":"allow","from":{"subject":"clients"},"proto":["any"],"source":{"id":"allow-clients-to-external-any","index":2,"kind":"rule","priority":200},"to":{"external":"default"}},{"action":"deny","from":{"subject":"clients"},"proto":["any"],"source":{"id":"deny-clients-to-mgmt","index":3,"kind":"rule","priority":150},"to":{"subject":"mgmt"}},{"action":"allow","from":{"external":"default"},"proto":["tcp/22"],"source":{"fromExternal":"default","index":0,"kind":"nat.ingress","toService":"external-jump-host"},"to":{"service":"external-jump-host"}}],"enforcement":{"authorityRoles":{"externalRib":"s-router-upstream-selector","internalRib":"s-router-policy"},"requirePolicyEngine":true,"transitForwarder":{"mustRejectOwnedPrefixes":true,"sink":"s-router-upstream-selector"}},"semantics":{"capabilityBindings":[{"capability":"resolver","scope":{"kind":"tenant","name":"mgmt"},"toService":{"kind":"service","name":"dns-site"}}],"catalog":{"capabilities":{"resolver":{"match":[{"dports":[53],"families":["ipv4","ipv6"],"l4":"udp"},{"dports":[53],"families":["ipv4","ipv6"],"l4":"tcp"}]}},"services":[{"kind":"service","match":[{"dports":[53],"families":["ipv4","ipv6"],"l4":"udp"},{"dports":[53],"families":["ipv4","ipv6"],"l4":"tcp"}],"name":"dns-site","scope":"site","zoneHint":{"kind":"tenant","name":"mgmt"}},{"exposure":{"external":true},"kind":"service","match":[{"dports":[22],"families":["ipv4","ipv6"],"l4":"tcp"}],"name":"external-jump-host","scope":"site","zoneHint":{"kind":"tenant","name":"mgmt"}}]},"enforcement":{"defaultEnforcerRole":"policy","egressEnforcerRole":"policy","ingressEnforcerRole":"core","nat":{"allowedRoles":["core"],"requiredRole":"core"}},"externalCatalog":{"default":{"families":["ipv4","ipv6"],"semantics":"internet"}},"invariants":[{"fromKinds":["tenant"],"kind":"mustTraverse","toKinds":["tenant"],"viaRole":"policy"},{"kind":"mustRejectOwnedFromExternal","sink":"s-router-upstream-selector"},{"allowedRoles":["core"],"kind":"natRealizationRestricted"}],"model":{"capabilitySemantics":"endpointSet","matchDefaults":{"dports":[],"families":["ipv4","ipv6"],"l4":"any","sports":[]},"precedence":{"defaultPriority":1000,"higherWins":true,"mode":"priority"},"statefulness":{"allowIsStateful":true,"denyAffects":"new"},"subjectBinding":{"endpointSets":[],"includeGatewayIps":true,"mode":"ownedPrefixes"}},"nat":{"egress":[{"egressProfile":"any","ipv4":{"kind":"snat"},"ipv6":{"kind":"none"},"realizeAtRole":"core","subject":{"kind":"tenant","name":"clients"},"toExternal":"default"}],"ingress":[{"fromExternal":"default","match":{"dports":[22],"families":["ipv4","ipv6"],"l4":"tcp"},"realizeAtRole":"core","toService":{"kind":"service","name":"external-jump-host"}}]},"natIngressImpliesAllow":true,"rawRules":[{"action":"allow","from":{"kind":"tenant","name":"admin"},"id":"allow-admin-to-mgmt-dns","priority":100,"to":{"capability":"resolver","kind":"tenant","name":"mgmt"}},{"action":"deny","from":{"kind":"tenant","name":"clients"},"id":"deny-clients-to-mgmt-dns","priority":90,"to":{"capability":"resolver","kind":"tenant","name":"mgmt"}},{"action":"allow","egressProfile":"any","from":{"kind":"tenant","name":"clients"},"id":"allow-clients-to-external-any","priority":200,"to":{"external":"default"}},{"action":"deny","from":{"kind":"tenant","name":"clients"},"id":"deny-clients-to-mgmt","priority":150,"to":{"kind":"tenant","name":"mgmt"}}]},"trafficClasses":["udp/53","tcp/53","any","tcp/22"]},"domains":{"tenants":[{"ipv4":"10.20.10.0/24","ipv6":"fd42:dead:beef:10::/64","name":"mgmt"},{"ipv4":"10.20.15.0/24","ipv6":"fd42:dead:beef:15::/64","name":"admin"},{"ipv4":"10.20.20.0/24","ipv6":"fd42:dead:beef:20::/64","name":"clients"}]},"enterprise":"esp0xdeadbeef","id":"esp0xdeadbeef.site-a","routerLoopbacks":{"s-router-access":{"ipv4":"10.19.0.1","ipv6":"fd42:dead:beef:1900:0:0:0:1"},"s-router-core":{"ipv4":"10.19.0.2","ipv6":"fd42:dead:beef:1900:0:0:0:2"},"s-router-policy":{"ipv4":"10.19.0.3","ipv6":"fd42:dead:beef:1900:0:0:0:3"},"s-router-upstream-selector":{"ipv4":"10.19.0.4","ipv6":"fd42:dead:beef:1900:0:0:0:4"}},"transit":{"addressAuthority":{"ipv4":"10.10.0.0/24","ipv6":"fd42:dead:beef:1000::/118"},"ordering":[["s-router-core","s-router-upstream-selector"],["s-router-upstream-selector","s-router-policy"],["s-router-policy","s-router-access"]]}}}}
